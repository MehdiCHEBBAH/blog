<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<link rel="stylesheet" href="../../css/blog-post.css" type="text/css">

<title>Deploy Microservices In Production</title>
<meta name="description" content="In this article we will learn the difference between deploying a monolithic application and deploying a microservices application, we will discuss the different available options and the advantages and disadvantages of each of them. So lets get straight into it.">
<meta name="robots" content="index, follow">
<meta property="og:type" content="article" />
<meta property="og:title" content="Deploy Microservices In Production" />
<meta property="og:description" content="In this article we will learn the difference between deploying a monolithic application and deploying a microservices application, we will discuss the different available options and the advantages and disadvantages of each of them. So lets get straight into it." />
<meta property="og:site_name" content="Mehdi CHEBBAH | Blog" />
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=' first-line-indent'><div style="text-align:center;font-size:30px">﷽</div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div style="text-align:center;font-size:48px">Deploy Microservices In Production</div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span>Written by </span><strong><span>Mehdi CHEBBAH</span></strong><span> &amp; </span><strong><span>Yacine ZIDELMAL</span></strong><span>.</span></p><hr /><p><img src="assets/How to deploy a microservices application.jpg" referrerpolicy="no-referrer" alt="How to deploy a microservices application"></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n104"><a class="md-toc-inner" href="#introduction">Introduction</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n5"><a class="md-toc-inner" href="#deployment-techniques">Deployment techniques</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n7"><a class="md-toc-inner" href="#multiple-service-instances-per-host">Multiple service instances per host</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n24"><a class="md-toc-inner" href="#single-service-instance-per-host">Single service instance per host</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n41"><a class="md-toc-inner" href="#service-instance-per-vm">Service instance per VM</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n60"><a class="md-toc-inner" href="#service-instance-per-container">Service instance per Container</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n98"><a class="md-toc-inner" href="#conclusion">Conclusion</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n126"><a class="md-toc-inner" href="#further-reading">Further Reading</a></span></p></div><hr /><h1 id='introduction'><span>Introduction</span></h1><p><span>In this article we will learn the difference between deploying a monolithic application and deploying a microservices application, we will discuss the different available options and the advantages and disadvantages of each of them. So lets get straight into it.</span></p><p><span>Deploying a monolithic application means running multiple, identical copies of a single, usually large application. You typically provision N servers (physical or virtual) and run M instances of the application on each one. The deployment of a monolithic application is not always entirely straightforward, but it is much simpler than deploying a microservices application.</span></p><p><span>A microservices application consists of tens -or even hundreds- of services. Services are written in a variety of languages and frameworks. Each one is a mini‑application with its own specific deployment, resources, scaling, and monitoring requirements. For example, you need to run a certain number of instances of each service based on the demand for that service. Also, each service instance must be provided with the appropriate CPU, memory, and I/O resources. What is even more challenging is that despite this complexity, deploying services must be fast, reliable and cost‑effective.</span></p><h1 id='deployment-techniques'><span>Deployment techniques</span></h1><p><span>There are multiple ways of deploying a microservices based system, here they are:</span></p><h2 id='multiple-service-instances-per-host'><span>Multiple service instances per host</span></h2><p><span>The first way is to run multiple instances of different services on a host (Physical or Virtual machine). The deployed system looks like this:</span></p><p><img src="assets/Deployment-shared_host.png" style="zoom: 80%;" /></p><p><span>The benefits of this pattern include:</span></p><ul><li><span>More efficient resource utilization than one service instance per host (The next pattern).</span></li></ul><p><span>The drawbacks of this approach include:</span></p><ul><li><span>Risk of conflicting resource requirements;</span></li><li><span>Risk of conflicting dependency versions;</span></li><li><span>Difficult to limit the resources consumed by a service instance;</span></li><li><span>If multiple services instances are deployed in the same process then its difficult to monitor the resource consumption of each service instance. Its also impossible to isolate each instance.</span></li></ul><h2 id='single-service-instance-per-host'><span>Single service instance per host</span></h2><p><span>The second option is to deploy each single service instance on its own host. An example of this deployment pattern is shown here:</span></p><p><img src="assets/Deployment-shared_nothing.png" style="zoom: 80%;" /></p><p><span>The benefits of this approach include:</span></p><ul><li><span>Services instances are isolated from one another;</span></li><li><span>There is no possibility of conflicting resource requirements or dependency versions;</span></li><li><span>A service instance can only consume at most the resources of a single host;</span></li><li><span>Its straightforward to monitor, manage, and redeploy each service instance;</span></li></ul><p><span>The drawbacks of this approach include:</span></p><ul><li><span>Potentially less efficient resource utilization compared to Multiple Services per Host because there are more hosts.</span></li></ul><h2 id='service-instance-per-vm'><span>Service instance per VM</span></h2><p><span>Package the service as a virtual machine image and deploy each service instance as a separate VM. This means the system will look like this:</span></p><p><img src="assets/Deployment-VMs.png" style="zoom: 80%;" /></p><p><span>The benefits of this approach include:</span></p><ul><li><span>Its straightforward to scale the service by increasing the number of instances;</span></li><li><span>The VM encapsulates the details of the technology used to build the service;</span></li><li><span>Each service instance is isolated;</span></li><li><span>A VM imposes limits on the CPU and memory consumed by a service instance;</span></li><li><span>IaaS solutions such as AWS provide a mature and feature rich infrastructure for deploying and managing virtual machines;</span></li></ul><p><span>The drawbacks of this approach include:</span></p><ul><li><span>Building a VM image is slow and time consuming.</span></li></ul><h2 id='service-instance-per-container'><span>Service instance per Container</span></h2><p><span>Package the service as a container image and deploy each service instance as a container.  Docker could be used to create container images and these containers could be manipulated using a framework such us Docker Compose, Kubernetes, Marathon/Mesos, ...etc. This solution is presented in the following figure:</span></p><p><img src="assets/Deployment-containers.png" style="zoom: 80%;" /></p><p><span>The benefits of this approach include:</span></p><ul><li><span>It is straightforward to scale up and down a service by changing the number of container instances;</span></li><li><span>The container encapsulates the details of the technology used to build the service;</span></li><li><span>Each service instance is isolated;</span></li><li><span>A container imposes limits on the CPU and memory consumed by a service instance;</span></li><li><span>Containers are extremely fast to build and start. For example, it’s 100x faster to package an application as a Docker container than it is to package it as a VM. Docker containers also start much faster than a VM since only the application process starts rather than an entire OS.</span></li></ul><p><span>The drawbacks of this approach include:</span></p><ul><li><span>The infrastructure for deploying containers is not as rich as the infrastructure for deploying virtual machines.</span></li></ul><h1 id='conclusion'><span>Conclusion</span></h1><p><span>We can recap the pros and cons of the mentioned 4 strategies in the following table:</span></p><figure><table><thead><tr><th>&nbsp;</th><th style='text-align:center;' ><span>Multiple instances per host</span></th><th style='text-align:center;' ><span>Single instance per host</span></th><th style='text-align:center;' ><span>Single instance per VM</span></th><th style='text-align:center;' ><span>Single instance per container</span></th></tr></thead><tbody><tr><td><span>Isolation</span></td><td style='text-align:center;' ><span>No isolation</span></td><td style='text-align:center;' ><span>Isolated</span></td><td style='text-align:center;' ><span>Isolated</span></td><td style='text-align:center;' ><span>Isolated</span></td></tr><tr><td><span>Risk of conflicts</span></td><td style='text-align:center;' ><span>Yes</span></td><td style='text-align:center;' ><span>No</span></td><td style='text-align:center;' ><span>No</span></td><td style='text-align:center;' ><span>No</span></td></tr><tr><td><span>Resources management</span></td><td style='text-align:center;' ><span>No</span></td><td style='text-align:center;' ><span>Yes</span></td><td style='text-align:center;' ><span>Yes</span></td><td style='text-align:center;' ><span>Yes</span></td></tr><tr><td><span>third-party solutions</span></td><td style='text-align:center;' ><span>No solutions</span></td><td style='text-align:center;' ><span>Some solutions</span></td><td style='text-align:center;' ><span>Multiple solutions</span></td><td style='text-align:center;' ><span>A lot of solutions</span></td></tr><tr><td><span>Resources efficiency</span></td><td style='text-align:center;' ><span>Efficient</span></td><td style='text-align:center;' ><span>Not efficient</span></td><td style='text-align:center;' ><span>Efficient</span></td><td style='text-align:center;' ><span>Very efficient</span></td></tr><tr><td><span>Scaling</span></td><td style='text-align:center;' ><span>Hard</span></td><td style='text-align:center;' ><span>Easy</span></td><td style='text-align:center;' ><span>Very easy</span></td><td style='text-align:center;' ><span>Very easy</span></td></tr><tr><td><span>Build time</span></td><td style='text-align:center;' ><span>/</span></td><td style='text-align:center;' ><span>/</span></td><td style='text-align:center;' ><span>Slow</span></td><td style='text-align:center;' ><span>Fast</span></td></tr></tbody></table></figure><h1 id='further-reading'><span>Further Reading</span></h1><ol><li><em><span>Deploying Microservices: Choosing a Strategy</span></em><span> (2016) </span><em><span>NGINX</span></em><span>. Available at: </span><a href='https://www.nginx.com/blog/deploying-microservices/' target='_blank' class='url'>https://www.nginx.com/blog/deploying-microservices/</a><span> (Accessed: 24 December 2021).</span></li><li><em><span>Deploying microservices</span></em><span>. Available at: </span><a href='https://microservices.io/articles/deployment.html' target='_blank' class='url'>https://microservices.io/articles/deployment.html</a><span> (Accessed: 24 December 2021).</span></li></ol></div></div>
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = "http://mehdi-chebbah.ml/deploy-microservices-in-production/";
        this.page.identifier = "deploy-microservices-in-production";
    };
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mehdi-chebbah.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</body>
</html>
<!doctype html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-widthinitial-scale=1"><link rel="stylesheet" href="../../css/blog-post.css" type="text/css"><title>Sentiment Analysis for Arabic Comments</title><meta name="description" content="This blog post shows how to build a Machine Learning model for Sentiment analysis in Arabic comments Using Naive-bayes."><meta name="robots" content="index, follow"><meta property="og:type" content="article"><meta property="og:title" content="Sentiment Analysis for Arabic Comments"><meta property="og:description" content="This blog post shows how to build a Machine Learning model for Sentiment analysis in Arabic comments Using Naive-bayes."><meta property="og:image" content=""><meta property="og:site_name" content="Mehdi CHEBBAH | Blog"></head><body class="typora-export"><div class="typora-export-content"><div id="write" class="first-line-indent"><div style="text-align:center;font-size:30px">﷽</div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div><div style="text-align:center;font-size:48px">Arabic NLP</div><div style="text-align:center;font-size:35px">Sentiment Analysis for Arabic Comments</div></div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span>Done by </span><strong><span>Mehdi CHEBBAH</span></strong></p><hr><p>&nbsp;</p><h1 id="table-of-contents"><span>Table Of Contents</span></h1><div class="md-toc" mdtype="toc"><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n470"><a class="md-toc-inner" href="#table-of-contents">Table Of Contents</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n380"><a class="md-toc-inner" href="#introduction">Introduction</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n150"><a class="md-toc-inner" href="#working-environment">Working environment</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n151"><a class="md-toc-inner" href="#anaconda">Anaconda</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n153"><a class="md-toc-inner" href="#spyder">Spyder</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n155"><a class="md-toc-inner" href="#scikit-learn">Scikit-learn</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n157"><a class="md-toc-inner" href="#pandas">Pandas</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n161"><a class="md-toc-inner" href="#building-the-model">Building the model</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n162"><a class="md-toc-inner" href="#phase-i-data-set-preparation">Phase I: Data-set preparation</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n188"><a class="md-toc-inner" href="#phase-ii-training">Phase II: Training</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n194"><a class="md-toc-inner" href="#phase-iii-validation">Phase III: Validation</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n198"><a class="md-toc-inner" href="#the-confusion-matrix">The confusion matrix</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n201"><a class="md-toc-inner" href="#the-accuracy">The accuracy</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n204"><a class="md-toc-inner" href="#phase-iv-trial">Phase IV: Trial</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n208"><a class="md-toc-inner" href="#conclusion">Conclusion</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n212"><a class="md-toc-inner" href="#bibliography--webography">Bibliography &amp; Webography</a></span></p></div><hr><h1 id="introduction"><span>Introduction</span></h1><p><span>In what follows we will try to build a model that classifies comments (in Arabic) on a given product into 3 classes:</span></p><ul><li><strong><span>Positive</span></strong><span>: This class contains comments deemed positive about the product.</span></li><li><strong><span>Negatives</span></strong><span>: This class contains comments deemed negative about the product.</span></li><li><strong><span>Mixed</span></strong><span>: This class contains comments that are objective (Contains positive points and negative points)</span></li></ul><p><span>To make the classification we will use the </span><strong><span>Naïve Bayes</span></strong><span> algorithm which is a probabilistic classifier based on the </span><em><span>bayes theorem</span></em><span>. This method is among the (classic) methods most used to perform sentiment analysis or more generally natural language processing.</span></p><h2 id="working-environment"><span>Working environment</span></h2><h3 id="anaconda"><span>Anaconda</span></h3><p><a href="https://www.anaconda.com/"><span>Anaconda</span></a><span> is a utility for </span><strong><span>Python</span></strong><span> offering many features. It offers for example the possibility to </span><strong><span>install libraries</span></strong><span> and to use them in its programs, but also offers software to </span><strong><span>help developers</span></strong><span> to have a complete development environment quickly.</span></p><h3 id="spyder"><span>Spyder</span></h3><p><a href="https://www.spyder-ide.org/"><span>Spyder</span></a><span> (named Pydee in its first versions) is a </span><strong><span>development environment</span></strong><span> for </span><strong><span>Python</span></strong><span>. </span><strong><span>Free</span></strong><span> (MIT license) and multi-platform, it integrates many libraries for scientific use </span><strong><span>Matplotlib</span></strong><span>, </span><strong><span>NumPy</span></strong><span>, </span><strong><span>SciPy</span></strong><span> and </span><strong><span>IPython</span></strong><span>.</span></p><h3 id="scikit-learn"><span>Scikit-learn</span></h3><p><a href="https://scikit-learn.org/stable/"><span>Scikit-learn</span></a><span> is a </span><strong><span>free</span></strong><span> </span><strong><span>Python</span></strong><span> library for </span><strong><span>machine learning</span></strong><span>. It is developed by many contributors, especially in the academic world by French higher education and research institutes like Inria and Télécom Paris. It includes functions for estimating random forests, logistic regressions, classification algorithms, and support vector machines. It is designed to harmonize with other free Python libraries, notably </span><strong><span>NumPy</span></strong><span> and </span><strong><span>SciPy</span></strong><span>.</span></p><h3 id="pandas"><span>Pandas</span></h3><p><a href="https://pandas.pydata.org/"><span>Pandas</span></a><span> is a </span><strong><span>library</span></strong><span> written for the </span><strong><span>Python</span></strong><span> programming language for </span><strong><span>data manipulation and analysis</span></strong><span>. In particular, it offers </span><strong><span>data structures</span></strong><span> and </span><strong><span>operations for manipulating numerical tables</span></strong><span> and time series. Pandas is a </span><strong><span>free software under BSD license</span></strong><span>.</span></p><hr><p>&nbsp;</p><h1 id="building-the-model"><span>Building the model</span></h1><h2 id="phase-i-data-set-preparation"><span>Phase I: Data-set preparation</span></h2><p><span>Regarding the data-set used in this analysis it is available </span><a href="https://www.kaggle.com/abedkhooli/arabic-100k-reviews"><span>here</span></a><span>.</span></p><p><span>It is 100K (99999) reviews on different products, the dataset combines reviews of hotels, books, movies, products and some airlines.</span></p><p><span>It has three classes (mixed, negative and positive). Most were mapped from the reviewers&#39; ratings, with 3 being mixed, above 3 positive, and below 3 negative. Each row has a label and text separated by a tab (tsv).</span></p><p><span>The text (notice) was cleaned by removing Arabic numerals and non-Arabic characters. There are no duplicate reviews in the dataset.</span></p><p><span>First, we want to import the data-set:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
                <div>2</div>
            </div>
        </div>
        <div class="CodeMirror-measure"></div>
        <div style="position:relative;z-index:1"></div>
        <div class="CodeMirror-code" role="presentation">
            <div class="CodeMirror-activeline" style="position:relative">
                <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
                <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px"></div>
                <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px">
                    <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div>
                </div>
                <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre>
            </div>
            <div style="position:relative">
                <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                    <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">2</div>
                </div>
                <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">dataset</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-string">'ar_reviews_100k.tsv'</span>, <span class="cm-variable">sep</span>=<span class="cm-string">'\t'</span>)</span></pre>
            </div>
        </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:40px"></div>
    <div class="CodeMirror-gutters" style="height:40px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p><span>In order for the analysis to be of better quality, we need to do another data cleaning where we eliminate the empty words (</span><strong><span>Stop Words</span></strong><span>) that will falsify our analysis (or degrade the results)</span></p><p><span>A stop word is an insignificant word in a text. It is so common that it is useless to include it in the analysis.</span></p><p><span>Examples of stop words: أنا, كان, منذ, حتى, غير, و</span></p><p><span>To remove these words we will use a list of Arabic stop words available </span><a href="https://sourceforge.net/projects/arabicstopwords/files/arabicstopwords0.3.zip/download"><span>here</span></a><span>.</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
    <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
        <div>2</div>
    </div>
    </div>
    <div class="CodeMirror-measure"></div>
    <div style="position:relative;z-index:1"></div>
    <div class="CodeMirror-code" role="presentation">
        <div class="CodeMirror-activeline" style="position:relative">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px">
            </div>
            <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">stopwords</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-string">'ar_stopwords.txt'</span>, <span class="cm-variable">header</span> = <span class="cm-keyword">None</span>)</span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">2</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">dataset</span>[<span class="cm-string">'text'</span>] = <span class="cm-variable">dataset</span>[<span class="cm-string">'text'</span>].<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">' '</span>.<span class="cm-property">join</span>([<span class="cm-variable">word</span> <span class="cm-keyword">for</span> <span class="cm-variable">word</span> <span class="cm-keyword">in</span> <span class="cm-variable">x</span>.<span class="cm-property">split</span>() <span class="cm-keyword">if</span> <span class="cm-variable">word</span> <span class="cm-keyword">not</span> <span class="cm-keyword">in</span> (<span class="cm-variable">stopwords</span>)]))</span></pre>
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:60px"></div>
    <div class="CodeMirror-gutters" style="height:60px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p><span>Then we will split the data-set into </span><em><span>Features (X)</span></em><span> and </span><em><span>Labels (y)</span></em><span>:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
    <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
        <div>2</div>
    </div>
    </div>
    <div class="CodeMirror-measure"></div>
    <div style="position:relative;z-index:1"></div>
    <div class="CodeMirror-code" role="presentation">
        <div class="CodeMirror-activeline" style="position:relative">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px">
            </div>
            <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">X</span> = <span class="cm-variable">dataset</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">1</span>].<span class="cm-property">values</span></span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">2</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">y</span> = <span class="cm-variable">dataset</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">0</span>].<span class="cm-property">values</span></span></pre>
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:40px"></div>
    <div class="CodeMirror-gutters" style="height:40px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p><span>Then we split our data-set into </span><em><span>Train</span></em><span> and </span><em><span>Test</span></em><span>.</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
    <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
        <div>2</div>
    </div>
    </div>
    <div class="CodeMirror-measure"></div>
    <div style="position:relative;z-index:1"></div>
    <div class="CodeMirror-code" role="presentation">
        <div class="CodeMirror-activeline" style="position:relative">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px">
            </div>
            <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">2</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">X</span>, <span class="cm-variable">y</span>, <span class="cm-variable">test_size</span> = <span class="cm-number">0.3</span>, <span class="cm-variable">random_state</span> = <span class="cm-number">0</span>)</span></pre>
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:40px"></div>
    <div class="CodeMirror-gutters" style="height:40px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><ul><li><span>Finally to do the analysis using the </span><strong><span>Naïve bayes</span></strong><span> algorithm we need to extract the &quot;</span><strong><span>features</span></strong><span>&quot; of the text (</span><strong><span>Feature extraction</span></strong><span>). To do this there are several approaches for example:</span></li><li><strong><span>Term Frequency(TF):</span></strong><span> This method is simply based on the calculation of word frequencies in documents. It gives importance to the most used words.</span></li><li><strong><span>Inverse Document Frequency(IDF) :</span></strong><span> This method gives importance to words rarely used in documents.</span></li><li><strong><span>Term Frequency-Inverse Document Frequency(TF-IDF):</span></strong><span> This is the product of </span><strong><span>TF</span></strong><span> and </span><strong><span>IDF</span></strong><span>. This statistical measure evaluates the importance of a term contained in a document, relative to a collection or a corpus.</span></li></ul><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
    <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
        <div>5</div>
    </div>
    </div>
    <div class="CodeMirror-measure"></div>
    <div style="position:relative;z-index:1"></div>
    <div class="CodeMirror-code" role="presentation" style="">
        <div class="CodeMirror-activeline" style="position:relative">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px">
            </div>
            <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">feature_extraction</span>.<span class="cm-property">text</span> <span class="cm-keyword">import</span> <span class="cm-variable">TfidfVectorizer</span></span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left:0;width:18px">2</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">v</span> = <span class="cm-variable">TfidfVectorizer</span>()</span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left:0;width:18px">3</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">v</span>.<span class="cm-property">max_features</span> = <span class="cm-number">5000</span> <span class="cm-comment"># plus ce parametere est grand plus les performances sont mieux mais la phase du training devient consommatrice de la RAM</span></span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left:0;width:18px">4</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">X_train</span> = <span class="cm-variable">v</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">X_train</span>).<span class="cm-property">toarray</span>()</span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">5</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">X_test</span> = <span class="cm-variable">v</span>.<span class="cm-property">transform</span>(<span class="cm-variable">X_test</span>).<span class="cm-property">toarray</span>()</span></pre>
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:120px"></div>
    <div class="CodeMirror-gutters" style="height:120px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p>&nbsp;</p><h2 id="phase-ii-training"><span>Phase II: Training</span></h2><p><span>Now after the preparation of the data-set we can easily build our model by running the following code:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre>
    <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
        <div>3</div>
    </div>
    </div>
    <div class="CodeMirror-measure"></div>
    <div style="position:relative;z-index:1"></div>
    <div class="CodeMirror-code" role="presentation">
        <div class="CodeMirror-activeline" style="position:relative">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px">
            </div>
            <div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">naive_bayes</span> <span class="cm-keyword">import</span> &nbsp;<span class="cm-variable">MultinomialNB</span></span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left:0;width:18px">2</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">classifier</span> = <span class="cm-variable">MultinomialNB</span>()</span></pre>
        </div>
        <div style="position:relative">
            <div class="CodeMirror-gutter-wrapper" style="left:-27px">
                <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">3</div>
            </div>
            <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">classifier</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre>
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:60px"></div>
    <div class="CodeMirror-gutters" style="height:60px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><blockquote><h4 id="note"><span>Note:</span></h4><p><span>We can try using a different </span><em><span>kernel</span></em><span> For example the </span><strong><span>Gaussian</span></strong><span> but in practice the </span><em><span>kernel</span></em><span> that gives the best </span><em><span>accuracy</span></em><span> in our case is the </span><strong><span>Multinomial</span></strong><span> </span><em><span>kernel</span></em><span>.</span></p></blockquote><h2 id="phase-iii-validation"><span>Phase III: Validation</span></h2><p><span>We can try to test our model on the test-set (Cross-validation) by running the following code:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position:relative;z-index:1"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position:relative"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">y_pred</span> = <span class="cm-variable">classifier</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:20px"></div>
    <div class="CodeMirror-gutters" style="height:20px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p><span>Then we can calculate the different measures of model performance for example:</span></p><h3 id="the-confusion-matrix"><span>The confusion matrix</span></h3><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position:relative;z-index:1"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position:relative"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">confusion_matrix</span></span></pre>
    </div>
    <div style="position:relative" class="">
        <div class="CodeMirror-gutter-wrapper" style="left:-27px">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">2</div>
        </div>
        <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">cm</span> = <span class="cm-variable">confusion_matrix</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred</span>, <span class="cm-variable">labels</span>=[<span class="cm-string">'Positive'</span>, <span class="cm-string">'Mixed'</span>, <span class="cm-string">'Negative'</span>])</span></pre>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:40px"></div>
    <div class="CodeMirror-gutters" style="height:40px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p><img src="assets/DeepinScreenshot_dde-desktop_20200501160841.png" referrerpolicy="no-referrer" alt="DeepinScreenshot_dde-desktop_20200501160841"></p><h3 id="the-accuracy"><span>The accuracy</span></h3><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow:hidden;position:relative;width:3px;height:0;top:8px;left:31px"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position:absolute;bottom:-1em;padding:0;width:1000px;height:1em;outline:0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left:27px;margin-bottom:0;border-right-width:0;padding-right:0;padding-bottom:0"><div style="position:relative;top:0"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position:relative;outline:0"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position:relative;z-index:1"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position:relative"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left:-27px;width:27px"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left:-27px"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">1</div></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">accuracy_score</span></span></pre>
    </div>
    <div style="position:relative" class="">
        <div class="CodeMirror-gutter-wrapper" style="left:-27px">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left:0;width:18px">2</div>
        </div>
        <pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right:.1px"><span class="cm-variable">accuracy</span> = <span class="cm-variable">accuracy_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred</span>)</span></pre>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div style="position:absolute;height:0;width:1px;border-bottom:0 solid transparent;top:40px"></div>
    <div class="CodeMirror-gutters" style="height:40px">
        <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width:26px"></div>
    </div>
    </div>
    </div>
    </pre><p><img src="assets/DeepinScreenshot_select-area_20200501160552.png" referrerpolicy="no-referrer" alt="DeepinScreenshot_select-area_20200501160552"></p><h2 id="phase-iv-trial"><span>Phase IV: Trial</span></h2><p><span>You can also test the model manually on real comments for example:</span></p><p><img src="assets/DeepinScreenshot_dde-desktop_20200501160751.png" referrerpolicy="no-referrer" alt="DeepinScreenshot_dde-desktop_20200501160751"></p><hr><h1 id="conclusion"><span>Conclusion</span></h1><p><span>We can further increase the accuracy of our model by eliminating more empty words and increasing the number of features used (we used </span><code>5000</code><span> in this model).</span></p><p><span>For this model to be really useful we need to invest in the dialect language since most comments in social networks are written in dialect which limits the use of the model.</span></p><p><span>We can also try to build a model that analyzes the sentiments of comments that contain emojis since they are widely used in comments.</span></p><h1 id="bibliography--webography"><span>Bibliography &amp; Webography</span></h1><ol start=""><li><a href="https://en.wikipedia.org/wiki/Anaconda_(Python_distribution)" target="_blank" class="url">https://en.wikipedia.org/wiki/Anaconda_(Python_distribution)</a><span> (fr)</span></li><li><a href="https://fr.wikipedia.org/wiki/Pandas" target="_blank" class="url">https://fr.wikipedia.org/wiki/Pandas</a><span> (fr)</span></li><li><a href="https://fr.wikipedia.org/wiki/Scikit-learn" target="_blank" class="url">https://fr.wikipedia.org/wiki/Scikit-learn</a><span> (fr)</span></li><li><a href="https://fr.wikipedia.org/wiki/Spyder_(logiciel)" target="_blank" class="url">https://fr.wikipedia.org/wiki/Spyder_(logiciel)</a><span> (fr)</span></li><li><a href="https://www.kaggle.com/abedkhooli/arabic-100k-reviews" target="_blank" class="url">https://www.kaggle.com/abedkhooli/arabic-100k-reviews</a><span> (en)</span></li><li><a href="https://sourceforge.net/projects/arabicstopwords/files/arabicstopwords0.3.zip/" target="_blank" class="url">https://sourceforge.net/projects/arabicstopwords/files/arabicstopwords0.3.zip/</a><span> (en)</span></li><li><a href="https://scikit-learn.org/stable/" target="_blank" class="url">https://scikit-learn.org/stable/</a><span> (en)</span></li></ol></div></div><div id="disqus_thread"></div><script>var disqus_config=function(){this.page.url="http://mehdi-chebbah.ml/Analyse-des-sentiments-pour-les-commentaires-arabes/",this.page.identifier="Analyse-des-sentiments-pour-les-commentaires-arabes"};(function(){var e=document,t=e.createElement("script");t.src="https://mehdi-chebbah.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>